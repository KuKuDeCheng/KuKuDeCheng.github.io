import{_ as o,a as p,b as i,c as l,d as u,e as c,f as r,g as d,h as k,i as v,j as m,k as q,l as b,m as h,n as g,o as y,p as f,q as w,r as S,s as j,t as x,u as _,v as N}from"./22.ab4b4c2a.js";import{_ as O}from"./plugin-vue_export-helper.21dcd24c.js";import{r as T,o as I,c as R,a as n,b as t,e as s,d as e}from"./app.e98d52ae.js";const J={},C=n("p",null,"Content\uFF1A",-1),L=n("p",null,"If there is any mistake, please leave a message.If reproduced, please indicate the source.",-1),z=s("Jolt GitHub: "),A={href:"https://github.com/bazaarvoice/jolt",target:"_blank",rel:"noopener noreferrer"},F=s("https://github.com/bazaarvoice/jolt"),U=s("Jolt online demo: "),H={href:"https://jolt-demo.appspot.com",target:"_blank",rel:"noopener noreferrer"},V=s("https://jolt-demo.appspot.com"),K=s('JSON to JSON transformation library written in Java where the "specification" for the transform is itself a JSON '),D={href:"http://document.In",target:"_blank",rel:"noopener noreferrer"},M=s("document.In"),B=s(` the following documents, I use 'Spec' instead of "specification" json document . LHS(left hand side) represents the keys of Spec json, and RHS(right hand side) represents the values of Spec json. Some of the examples are referenced Jolt source code comment documents.`),E=e('<p>Useful For:</p><ol><li>Transforming JSON data from ElasticSearch, MongoDb, Cassandra, etc before sending it off to the world</li><li>Extracting data from a large JSON documents for your own consumption</li></ol><h2 id="overview" tabindex="-1"><a class="header-anchor" href="#overview" aria-hidden="true">#</a> Overview</h2><p>Jolt :</p><ul><li><p>provides a set of transforms, that can be &quot;chained&quot; together to form the overall JSON to JSON transform.</p></li><li><p>focuses on transforming the structure of your JSON data, not manipulating specific values</p><ul><li>The idea being: use Jolt to get most of the structure right, then write code to fix values</li></ul></li><li><p>consumes and produces &quot;hydrated&quot; JSON : in-memory tree of Maps, Lists, Strings, etc</p><ul><li>use Jackson (or whatever) to serialize and deserialize the JSON text</li></ul></li></ul><h2 id="alternatives" tabindex="-1"><a class="header-anchor" href="#alternatives" aria-hidden="true">#</a> Alternatives</h2><p>Being in the Java JSON processing &quot;space&quot;, here are some other interesting JSON manipulation tools to look at / consider :</p>',7),P={href:"https://stedolan.github.io/jq",target:"_blank",rel:"noopener noreferrer"},W=s("jq"),$=s("Awesome command line tool to extract data from JSON files (use it all the time, available via brew)"),G={href:"https://github.com/jayway/JsonPath",target:"_blank",rel:"noopener noreferrer"},Y=s("JsonPath"),Q=s(" Java : Extract data from JSON using XPATH like syntax."),X={href:"https://github.com/jsurfer/JsonSurfer",target:"_blank",rel:"noopener noreferrer"},Z=s("JsonSurfer"),nn=s("Java : Streaming JsonPath processor dedicated to processing big and complicated JSON data."),sn=e(`<h2 id="performance" tabindex="-1"><a class="header-anchor" href="#performance" aria-hidden="true">#</a> Performance</h2><p>The primary goal of Jolt was to improve &quot;developer speed&quot; by providing the ability to have a declarative rather than imperative transforms. That said, Jolt should have a better runtime than the alternatives listed above.</p><p>Work has been done to make the stock Jolt transforms fast:</p><ol><li>Transforms can be initialized once with their spec, and re-used many times in a multi-threaded environment. <ul><li>We reuse initialized Jolt transforms to service multiple web requests from a DropWizard service.</li></ul></li><li>&quot;*&quot; wildcard logic was redone to reduce the use of Regex in the common case, which was a dramatic speed improvement.</li><li>The parallel tree walk performed by Shiftr was optimized.</li></ol><p>Two things to be aware of :</p><ol><li>Jolt is not &quot;stream&quot; based, so if you have a very large Json document to transform you need to have enough memory to hold it.</li><li>The transform process will create and discard a lot of objects, so the garbage collector will have work to do.</li></ol><h2 id="stock-transforms" tabindex="-1"><a class="header-anchor" href="#stock-transforms" aria-hidden="true">#</a> Stock Transforms</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>shift       : copy data from the input tree and put it the output tree
default     : apply default values to the tree
remove      : remove data from the tree
sort        : sort the Map key values alphabetically ( for debugging and human readability )
cardinality : &quot;fix&quot; the cardinality of input data.  Eg, the &quot;urls&quot; element is usually a List, but if there is only one, then it is a String
modify-overwrite-beta:This variant of modifier creates the key/index is missing, and overwrites the value if present
modify-default-beta:This variant of modifier only writes when the key/index is missing or the value is null
modify-define-beta:This variant of modifier only writes when the key/index is missing
full qualified Java ClassName : Class implements the Transform or ContextualTransform interfaces, and can optionally be SpecDriven (marker interface)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Each transform has its own DSL (Domain Specific Language) in order to facilitate its narrow job.</p><p>Currently, Currently, the top five Transforms just effect the &quot;structure&quot; of the data. To do data manipulation, you will need to write Java code or use modify function. If you write your Java &quot;data manipulation&quot; code to implement the Transform interface, then you can insert your code in the transform chain.</p><p>The out-of-the-box Jolt transforms should be able to do most of your structural transformation, with custom Java Transforms implementing your data manipulation.</p><p>Here is a Jolt guide in PDF:<a href="../jolt/JOLTIntroduction.pdf" download="JOLTIntroduction.pdf">Jolt\u4ECB\u7ECD</a></p>`,12),an=s("Google document PPT address online\uFF1A"),tn={href:"https://docs.google.com/presentation/d/1sAiuiFC4Lzz4-064sg1p8EQt2ev0o442MfEbvrpD1ls/edit?usp=sharing",target:"_blank",rel:"noopener noreferrer"},en=s("https://docs.google.com/presentation/d/1sAiuiFC4Lzz4-064sg1p8EQt2ev0o442MfEbvrpD1ls/edit?usp=sharing"),on=e(`<h2 id="shift" tabindex="-1"><a class="header-anchor" href="#shift" aria-hidden="true">#</a> shift</h2><p>Shiftr is a kind of JOLT transform that specifies where &quot;data&quot; from the input JSON should be placed in the output JSON, aka how the input JSON/data should be shifted around to make the output JSON/data.</p><p>At a base level, a single Shiftr &quot;command&quot; is a mapping from an input path to an output path, similar to the &quot;mv&quot; command in Unix, &quot;mv /var/data/mysql/data /media/backup/mysql&quot;.</p><p>In Shiftr, the input path is a JSON tree structure, and the output path is flattened &quot;dot notation&quot; path notation.</p><p>The idea is that you can start with a copy of your JSON input data and modify it into a Shiftr spec by supplying a &quot;dot notation&quot; output path for each piece of data that you care about.</p><p>For example, given this simple input JSON:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;rating&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
       <span class="token property">&quot;quality&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
          <span class="token property">&quot;max&quot;</span><span class="token operator">:</span> <span class="token number">5</span>
       <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>A simple Shiftr spec could be constructed by copying that input, and modifying it to supply an output path for each piece of data:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code> <span class="token punctuation">{</span>
    <span class="token property">&quot;rating&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;quality&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;SecondaryRatings.quality.Value&quot;</span><span class="token punctuation">,</span>     <span class="token comment">// copy 3 to &quot;SecondaryRatings.quality.Value&quot;</span>
          <span class="token property">&quot;max&quot;</span><span class="token operator">:</span> <span class="token string">&quot;SecondaryRatings.quality.RatingRange&quot;</span>  <span class="token comment">// copy 5 to &quot;SecondaryRatings.quality.RatingRange&quot;</span>
      <span class="token punctuation">}</span>   
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>would produce the following output JSON:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>  <span class="token punctuation">{</span>
    <span class="token property">&quot;SecondaryRatings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;quality&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;Value&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
        <span class="token property">&quot;RatingRange&quot;</span><span class="token operator">:</span> <span class="token number">5</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>As shown above, Shiftr specs can be entirely made up of literal string values, but its real power comes from its wildcards.Using wildcards, you can leverage the fact that you know, not just the data and its immediate key, but the whole input path to that data.</p><p>Expanding the example above, say we have the following expanded Input JSON:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;rating&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;primary&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>   <span class="token comment">// want this value to goto output path &quot;Rating&quot;</span>
          <span class="token property">&quot;max&quot;</span><span class="token operator">:</span> <span class="token number">5</span>      <span class="token comment">// want this value to goto output path &quot;RatingRange&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;quality&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>      <span class="token comment">// want output path &quot;SecondaryRatings.quality.Id&quot; = &quot;quality&quot;, aka we want the value of the key to be used</span>
          <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>   <span class="token comment">// want this value to goto output path &quot;SecondaryRatings.quality.Value&quot;</span>
          <span class="token property">&quot;max&quot;</span><span class="token operator">:</span> <span class="token number">5</span>      <span class="token comment">// want this value to goto output path &quot;SecondaryRatings.quality.Range&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;sharpness&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>   <span class="token comment">// want output path &quot;SecondaryRatings.sharpness.Id&quot; = &quot;sharpness&quot;</span>
          <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">7</span><span class="token punctuation">,</span>  <span class="token comment">// want this value to goto output path &quot;SecondaryRatings.sharpness.Value&quot;</span>
          <span class="token property">&quot;max&quot;</span><span class="token operator">:</span> <span class="token number">10</span>    <span class="token comment">// want this value to goto output path &quot;SecondaryRatings.sharpness.Range&quot;</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Spec:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;rating&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;primary&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Rating&quot;</span><span class="token punctuation">,</span>                       <span class="token comment">// output -&gt; &quot;Rating&quot; : 3</span>
        <span class="token property">&quot;max&quot;</span><span class="token operator">:</span> <span class="token string">&quot;RatingRange&quot;</span>                      <span class="token comment">// output -&gt; &quot;RatingRange&quot; : 5</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;*&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>                                        <span class="token comment">// match input data like &quot;rating.[anything-other-than-primary]&quot;</span>
        <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;SecondaryRatings.&amp;1.Value&quot;</span><span class="token punctuation">,</span>    <span class="token comment">// the data at &quot;rating.*.value&quot; goes to &quot;SecondaryRatings.*.Value&quot;</span>
                                                  <span class="token comment">// the &quot;&amp;1&quot; means use the value one level up the tree ( &quot;quality&quot; or &quot;sharpness&quot; )</span>
                                                <span class="token comment">// output -&gt; &quot;SecondaryRatings.quality.Value&quot; : 3 AND</span>
                                                <span class="token comment">//           &quot;SecondaryRatings.sharpness.Value&quot; : 7</span>

        <span class="token property">&quot;max&quot;</span><span class="token operator">:</span> <span class="token string">&quot;SecondaryRatings.&amp;1.Range&quot;</span><span class="token punctuation">,</span>      <span class="token comment">// the data at &quot;rating.*.max&quot; goes to &quot;SecondaryRatings.*.Range&quot;</span>
                                                 <span class="token comment">// the &quot;&amp;1&quot; means use the value one level up the tree ( &quot;quality&quot; or &quot;sharpness&quot; )</span>
                                                 <span class="token comment">// output -&gt; &quot;SecondaryRatings.quality.Range&quot; : 5 AND</span>
                                                  <span class="token comment">//           &quot;SecondaryRatings.sharpness.Range&quot; : 10</span>

        <span class="token property">&quot;$&quot;</span><span class="token operator">:</span> <span class="token string">&quot;SecondaryRatings.&amp;1.Id&quot;</span>            <span class="token comment">// Special operator $ means, use the value of the input key itself as the data</span>
                                                 <span class="token comment">// output -&gt; &quot;SecondaryRatings.quality.Id&quot; : &quot;quality&quot;</span>
                                                 <span class="token comment">// output -&gt; &quot;SecondaryRatings.sharpness.Id&quot; : &quot;sharpness&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Yielding the following output:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;Rating&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
  <span class="token property">&quot;RatingRange&quot;</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
  <span class="token property">&quot;SecondaryRatings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
     <span class="token property">&quot;quality&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;Range&quot;</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
        <span class="token property">&quot;Value&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
        <span class="token property">&quot;Id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;quality&quot;</span>     <span class="token comment">// the special $ operator allows us to use input key the text value of &quot;quality&quot;, as the &quot;Id&quot; of the output</span>
     <span class="token punctuation">}</span><span class="token punctuation">,</span>
     <span class="token property">&quot;sharpness&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;Range&quot;</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
        <span class="token property">&quot;Value&quot;</span><span class="token operator">:</span> <span class="token number">7</span><span class="token punctuation">,</span>
        <span class="token property">&quot;Id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sharpness&quot;</span>   <span class="token comment">// the special $ operator allows us to use input key the text value of &quot;sharpness&quot;, as the &quot;Id&quot; of the output</span>
     <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="shiftr-walkedpathtree" tabindex="-1"><a class="header-anchor" href="#shiftr-walkedpathtree" aria-hidden="true">#</a> Shiftr WalkedPathTree</h3><p>This part of the content is in the study of part of the source code and practice of the summary, there may be some mistakes, if someone see, please be sure to leave a message to correct!</p><p><strong>theory</strong>\uFF1A</p>`,21),pn=s("Jolt in shiftr, when processing input according to Spec, keeps a dynamic WalkedPath at all times, which is generally a "),ln={href:"http://linkedList.As",target:"_blank",rel:"noopener noreferrer"},un=s("linkedList.As"),cn=s(" a new match calculation operation, the current information (including a refTree, which is a reference to the input json, and a subKey, which is the key value matched) is saved to the WalkedPath\u3002When the calculation is completed at the leaf node in the Spec tree(including the matching calculation and the output calculation),the current stored information is removed from the WalkedPath.Although the outer layer of the WalkedPath is a linked list, drawing the entire WalkedPath path becomes a tree because of wildcards, multiple matches at the same level, and so on (recursion is in the code)."),rn=e('<p>For example, we saw an &amp;1 in the above example, and &amp; means to take the key value of the corresponding node, as explained below.Based on the example above, let&#39;s draw the WalkedPathTree when we first compute to &amp;1 <img src="'+o+'" alt="" loading="lazy"> Here is a screenshot of the program from debug to the first time it was calculated to &amp;1: <img src="'+p+'" alt="" loading="lazy"></p><p><img src="'+i+`" alt="" loading="lazy"></p><h3 id="shiftr-wildcards" tabindex="-1"><a class="header-anchor" href="#shiftr-wildcards" aria-hidden="true">#</a> Shiftr wildcards</h3><h4 id="wildcard" tabindex="-1"><a class="header-anchor" href="#wildcard" aria-hidden="true">#</a> &#39;*&#39; wildcard</h4><ol><li>Valid only on the LHS ( input JSON keys ) side of a Shiftr Spec</li><li>The &#39;*&#39; wildcard can be used by itself or to match part of a key.</li></ol><p>&#39;*&#39; wildcard by itself:</p><p>input\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;rating&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;quality&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
      <span class="token property">&quot;max&quot;</span><span class="token operator">:</span> <span class="token number">5</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;sharpness&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">7</span><span class="token punctuation">,</span>
      <span class="token property">&quot;max&quot;</span> <span class="token operator">:</span> <span class="token number">10</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>In this example, &quot;rating.quality&quot; and &quot;rating.sharpness&quot; both have the same structure/format, and thus we can use the &#39;*&#39; to allow us to write more compact rules and avoid having to explicitly write very similar rules for both &quot;quality&quot; and &quot;sharpness&quot;. Spec:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token property">&quot;operation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shift&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;spec&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;rating&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;*&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;max&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Rating.[#2].amx&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Rating.[#2].value&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+l+`" alt="" loading="lazy"></p><p>&#39;*&#39; wildcard as part of a key:</p><p>input\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
   <span class="token property">&quot;tag-Pro&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Awesome&quot;</span><span class="token punctuation">,</span>
   <span class="token property">&quot;tag-Con&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Bogus&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>A &#39;tag-*&#39; would match both keys, and make the whole key and &quot;matched&quot; part of the key available. Spec:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token property">&quot;operation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shift&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;spec&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;tag-*&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&amp;(0,1)&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>output: <img src="`+u+`" alt="" loading="lazy"></p><h4 id="wildcard-1" tabindex="-1"><a class="header-anchor" href="#wildcard-1" aria-hidden="true">#</a> &#39;&amp;&#39;wildcard</h4><ol><li>Valid on the LHS (left hand side - input JSON keys) and RHS (output data path)</li><li>The canonical form of the wildcard is &quot;&amp;(0,0)&quot;.The first parameter is where in the input path to look for a value, and the second parameter is which part of the key to use (used with * key).</li></ol><p>eg input:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;value&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;test2&quot;</span><span class="token operator">:</span> <span class="token string">&quot;value2&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Spec:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token property">&quot;operation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shift&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;spec&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;&amp;&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ratingNames&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>output\uFF1A <img src="`+c+`" alt="" loading="lazy"></p><p>&#39;&amp;&#39; Path lookup\uFF1AAs Shiftr processes data and walks down the spec, it maintains a data structure describing the path it has walked.The &#39;&amp;&#39; wildcard can access data from that path in a 0 major, upward oriented way.</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;foo&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;bar&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;baz&quot;</span><span class="token operator">:</span>  <span class="token comment">// &amp;0 = baz, &amp;1 = bar, &amp;2 = foo</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>&amp; Subkey lookup\uFF1A &#39;&amp;&#39; subkey lookup allows us to referece the values captured by the &#39;<em>&#39; wildcard.Example, &quot;tag-</em>-*&quot; would match &quot;tag-Foo-Bar&quot;, making</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code> &amp;(0,0) = &quot;tag-Foo-Bar&quot;
 &amp;(0,1) = &quot;Foo&quot;
 &amp;(0,2) = &quot;Bar&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="wildcard-2" tabindex="-1"><a class="header-anchor" href="#wildcard-2" aria-hidden="true">#</a> &#39;$&#39;Wildcard</h4><ol><li>Valid only on the LHS of the spec.</li><li>The existence of this wildcard is a reflection of the fact that the &quot;data&quot; of the input JSON, can be both in the &quot;values&quot; and the &quot;keys&quot; of the input JSON</li><li>The base case operation of Shiftr is to copy input JSON &quot;values&quot;, thus we need a way to specify that we want to copy the input JSON &quot;key&quot; instead.</li></ol><p>There are two cases where this is useful:</p>`,31),dn=s(`when a "key" in the input JSON needs to be a "id" value in the output JSON, see the ' "$": "SecondaryRatings.&`),kn={href:"http://1.Id",target:"_blank",rel:"noopener noreferrer"},vn=s("1.Id"),mn=s(`" ' example above.`),qn=n("li",null,"you want to make a list of all the input keys.",-1),bn=e(`<p>Example of &quot;a list of the input keys&quot;:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;rating&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;primary&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
      <span class="token property">&quot;max&quot;</span><span class="token operator">:</span> <span class="token number">5</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;quality&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
      <span class="token property">&quot;max&quot;</span><span class="token operator">:</span> <span class="token number">7</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>desired output:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;ratings&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;primary&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;quality&quot;</span> <span class="token punctuation">]</span>    <span class="token comment">// Aside: this is an example of implicit JSON array creation in the output which is detailed further down.</span>
                                          <span class="token comment">// For now just observe that the input keys &quot;primary&quot; and &quot;quality&quot; have both made it to the output.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Spec\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;rating&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;*&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>               <span class="token comment">// match all keys below &quot;rating&quot;</span>
      <span class="token property">&quot;$&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ratings&quot;</span>     <span class="token comment">// output each of the &quot;keys&quot; to &quot;ratings&quot; in the output</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="wildcard-3" tabindex="-1"><a class="header-anchor" href="#wildcard-3" aria-hidden="true">#</a> &#39;#&#39;Wildcard</h4><ol><li>Valid both on the LHS and RHS, but has different behavior / format on either side.</li><li>On the RHS of the spec, # is only valid in the the context of an array, like &quot;[#2]&quot;.What &quot;[#2]&quot; means is, go up the three levels and ask that node how many matches it has had, and then use that as an index in the arrays.</li><li>On the LHS of the spec, # allows you to specify a hard coded String to be place as a value in the output.</li><li>On the LHS of the spec,# is the root node and children are not allowed</li></ol><p>The initial use-case for this feature was to be able to process a Boolean input value, and if the value is boolean true write out the string &quot;enabled&quot;. Note, this was possible before, but it required two Shiftr steps.</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token property">&quot;hidden&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;true&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>                             <span class="token comment">// if the value of &quot;hidden&quot; is true</span>
        <span class="token property">&quot;#disabled&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;clients.clientId&quot;</span>   <span class="token comment">//write the word &quot;disabled&quot; to the path &quot;clients.clientId&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Let&#39;s do another example</p><p>input json:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;ratings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;primary&quot;</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
    <span class="token property">&quot;quality&quot;</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
    <span class="token property">&quot;design&quot;</span><span class="token operator">:</span> <span class="token number">5</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Spec:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token property">&quot;operation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shift&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;spec&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;ratings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;*&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token comment">// </span>
          <span class="token comment">// #2 means go three levels up the tree (count from 0),</span>
          <span class="token comment">//  and ask the &quot;ratings&quot; node, how many of it&#39;s</span>
          <span class="token comment">//  children have been matched.</span>
          <span class="token comment">//</span>
          <span class="token comment">// This allows us to put the Name and the Value into</span>
          <span class="token comment">//  the same object in the Ratings array.</span>
          <span class="token property">&quot;$&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Ratings[#2].Name&quot;</span><span class="token punctuation">,</span><span class="token comment">//$\u4E0A\u6587\u5DF2\u7ECF\u8BB2\u89E3 \u4F7Fkey\u4F5C\u4E3A\u8F93\u51FAvalue</span>
          <span class="token property">&quot;@&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Ratings[#2].Value&quot;</span><span class="token comment">//@\u4E0B\u6587\u4F1A\u8BB2\u89E3 </span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>output json:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;Ratings&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;Name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;primary&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;Value&quot;</span> <span class="token operator">:</span> <span class="token number">5</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;Name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;quality&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;Value&quot;</span> <span class="token operator">:</span> <span class="token number">4</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;Name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;design&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;Value&quot;</span> <span class="token operator">:</span> <span class="token number">5</span>
  <span class="token punctuation">}</span> <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Jolt demo said &#39;#2 means go three levels up the tree (count from 0)&#39;.But I think &#39;three levels up&#39; is ambiguous, WalkedPath is an array, starting from 0, assuming the length is 5, then the index corresponding to &#39;two levels up&#39; is labeled 5-1-2 = 2 ,So I think &#39;two levels up&#39; is actually the best way to read it.</p><p>The key parts of the source code are as follows: <img src="`+r+'" alt="" loading="lazy"> Hand-drawn drawings of walkedPathTree are as follows: <img src="'+d+`" alt="" loading="lazy"></p><h4 id="wildcard-4" tabindex="-1"><a class="header-anchor" href="#wildcard-4" aria-hidden="true">#</a> &#39;|&#39;Wildcard</h4><ol><li>Valid only on the LHS of the spec.</li></ol><p>This &#39;or&#39; wildcard allows you to match multiple input keys. Useful if you don&#39;t always know exactly what your input data will be.</p><p>Spec:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;rating|Rating&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;rating-primary&quot;</span>   <span class="token comment">// match &quot;rating&quot; or &quot;Rating&quot; copy the data to &quot;rating-primary&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="wildcard-5" tabindex="-1"><a class="header-anchor" href="#wildcard-5" aria-hidden="true">#</a> &#39;@&#39;Wildcard</h4><ol><li>Valid on both sides of the spec.</li><li>On the LHS of the spec,@ is the root node and children are not allowed</li></ol><p>This wildcard is necessary if you want to put both the input value and the input key somewhere in the output JSON.</p><p>Say we have a spec that just operates on the value of the input key &quot;rating&quot;\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;foo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;place.to.put.value&quot;</span><span class="token punctuation">,</span>  <span class="token comment">// leveraging the implicit operation of Shiftr which is to operate on input JSON values</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>if we want to do something with the &quot;key&quot; as well as the value Spec</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
   <span class="token property">&quot;foo&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
     <span class="token property">&quot;$&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;place.to.put.key&quot;</span><span class="token punctuation">,</span>
     <span class="token property">&quot;@&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;place.to.put.value&quot;</span>    <span class="token comment">// &#39;@&#39; explicitly tell Shiftr to operate on the input JSON value of the parent key &quot;foo&quot;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Thus the &#39;@&#39; wildcard is the mean &quot;copy the value of the data at this level in the tree, to the output&quot;.</p><p>Advanced &#39;@&#39; sign wildcard.The format is lools like &quot;@(3,title)&quot;, where &quot;3&quot; means go up the WalkedPath tree 3 levels and then lookup the key &quot;title&quot; and use the value at that key.</p><p>eg\uFF1A <img src="`+k+'" alt="" loading="lazy"></p><p>Debug screenshot when calculating @(2,test)\uFF1A <img src="'+v+'" alt="" loading="lazy"></p><p>Then, at the end of the calculation @(2,test2), walkedPathTree adds another level (in fact, @(2,test2), @(3,test2) returns treeRef at level 1 and treeRef at level 0, both subtrees are the root node, the effect is the same, as shown below \u{1F603} <img src="'+m+'" alt="" loading="lazy"></p><p>Replace @(2,test2) with @(3,test2) and the result is the same: <img src="'+q+'" alt="" loading="lazy"></p><p>The @ alone is equivalent to @0: <img src="'+b+`" alt="" loading="lazy"></p><p>Examples of @ wildcard in RHS:</p><p>input json:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
   <span class="token property">&quot;author&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;Stephen Hawking&quot;</span><span class="token punctuation">,</span>
   <span class="token property">&quot;book&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;A Brief History of Time&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>expected json</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
   <span class="token property">&quot;Stephen Hawking&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;A Brief History of Time&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Spec</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;@author&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;@book&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The @book for RHS is actually one more level than the walkedPathTree for calculating @author</p><h3 id="json-array" tabindex="-1"><a class="header-anchor" href="#json-array" aria-hidden="true">#</a> json Array</h3><p>Reading from (input) and writing to (output) JSON Arrays is fully supported.</p><h4 id="handling-arrays-in-the-input-json" tabindex="-1"><a class="header-anchor" href="#handling-arrays-in-the-input-json" aria-hidden="true">#</a> Handling Arrays in the input JSON</h4><p>Shiftr treats JSON arrays in the input data as Maps with numeric keys.</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
   <span class="token property">&quot;Photos&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;AAA.jpg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;BBB.jpg&quot;</span> <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Spec</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
   <span class="token property">&quot;Photos&quot;</span> <span class="token operator">:</span>
   <span class="token punctuation">{</span>
     <span class="token property">&quot;1&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;photo-&amp;-url&quot;</span>      <span class="token comment">// Specify that we only want to operate on the 1-th index of the &quot;Photos&quot; input array</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>output:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;photo-1-url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BBB.jpg&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="handling-arrays-in-the-output-json" tabindex="-1"><a class="header-anchor" href="#handling-arrays-in-the-output-json" aria-hidden="true">#</a> Handling Arrays in the output JSON</h4><p>Traditional array brackets, [ ], are used to specify array index in the output JSON. <strong>[]&#39;s are only valid on the RHS of the Shiftr spec.</strong></p><p>Example :</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;photo-1-id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;327704&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;photo-1-url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://bob.com/0001/327704/photo.jpg&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Spec:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;photo-1-id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Photos[1].Id&quot;</span><span class="token punctuation">,</span>   <span class="token comment">// Declare the &quot;Photos&quot; in the output to be an array,</span>
  <span class="token property">&quot;photo-1-url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Photos[1].Url&quot;</span>  <span class="token comment">// that the 1-th array location should have data</span>
  <span class="token comment">// same as above but more powerful</span>
  <span class="token comment">// note &#39;&amp;&#39; logic can be used inside the &#39;[ ]&#39; notation &quot;photo-*-url&quot;: &quot;Photos[&amp;(0,1)].Url&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>output:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;Photos&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token null keyword">null</span> <span class="token punctuation">,</span>                <span class="token comment">// note Photos[0] is null, because no data was pushed to it</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;Id&quot;</span><span class="token operator">:</span><span class="token string">&quot;327704&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;Url&quot;</span><span class="token operator">:</span><span class="token string">&quot;http://bob.com/0001/327704/photo.jpg&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="json-arrays-in-the-spec-file" tabindex="-1"><a class="header-anchor" href="#json-arrays-in-the-spec-file" aria-hidden="true">#</a> JSON arrays in the spec file</h4><p>JSON Arrays in Shiftr spec are used to to specify that piece of input data should be copied to two places in the output JSON.</p><p>Example :</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span> <span class="token property">&quot;foo&quot;</span> <span class="token operator">:</span> <span class="token number">3</span> <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Spec:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span> <span class="token property">&quot;foo&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;bar&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;baz&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>output:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;bar&quot;</span> <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
  <span class="token property">&quot;baz&quot;</span> <span class="token operator">:</span> <span class="token number">3</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="implicit-array-creation-in-the-output-json" tabindex="-1"><a class="header-anchor" href="#implicit-array-creation-in-the-output-json" aria-hidden="true">#</a> Implicit Array creation in the output JSON</h4><p>If a spec file is configured to output multiple pieces of data to the same output location, the output location will be turned into a JSON array.</p><p>Example :</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;foo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;bar&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;tuna&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;marlin&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Spec:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;foo&quot;</span>  <span class="token operator">:</span> <span class="token string">&quot;baz&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;tuna&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;baz&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>output\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;baz&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;bar&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;marlin&quot;</span> <span class="token punctuation">]</span>     <span class="token comment">// Note the order of this Array should not be relied upon</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="algorithm-high-level" tabindex="-1"><a class="header-anchor" href="#algorithm-high-level" aria-hidden="true">#</a> Algorithm High Level</h3><p>Walk the input data, and Shiftr spec simultaneously, and execute the Shiftr command/mapping each time there is a match.</p><h3 id="algorithm-low-level" tabindex="-1"><a class="header-anchor" href="#algorithm-low-level" aria-hidden="true">#</a> Algorithm Low Level</h3><ul><li>Simultaneously walk of the spec and input JSon, and maintain a walked &quot;input&quot; path data structure.</li><li>Determine a match between input JSON key and LHS spec, by matching LHS spec keys in the following order : <ul><li>Note that &#39;|&#39; keys are are split into their subkeys, eg &quot;literal&quot;, &#39;*&#39;, or &#39;&amp;&#39; LHS keys</li></ul><ol><li>Try to match the input key with &quot;literal&quot; spec key values</li><li>If no literal match is found, try to match against LHS &#39;&amp;&#39; computed values. <ul><li>For deterministic behavior, if there is more than one &#39;&amp;&#39; LHS key, they are applied/matched in alphabetical order,after the &#39;&amp;&#39; syntactic sugar is replaced with its canonical form.</li></ul></li><li>If no match is found, try to match against LHS keys with &#39;*&#39; wildcard values. <ul><li>For deterministic behavior, &#39;*&#39; wildcard keys are sorted and applied/matched in alphabetical order.</li></ul></li></ol></li></ul><p>Note, processing of the &#39;@&#39; and &#39;$&#39; LHS keys always occur if their parent&#39;s match, and do not block any other matching.</p><h2 id="default" tabindex="-1"><a class="header-anchor" href="#default" aria-hidden="true">#</a> default</h2><p>Defaultr is a kind of JOLT transform that applies default values in a non-destructive way.</p><p>For comparison :</p><ul><li>Shitr walks the input data and asks its spec &quot;Where should this go?&quot;</li><li>Defaultr walks the spec and asks &quot;Does this exist in the data? If not, add it.&quot;</li></ul><p>Example : Given input JSON like</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;Rating&quot;</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span>
  <span class="token property">&quot;SecondaryRatings&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
     <span class="token property">&quot;quality&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token property">&quot;Range&quot;</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">,</span>
        <span class="token property">&quot;Value&quot;</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span>
        <span class="token property">&quot;Id&quot;</span><span class="token operator">:</span><span class="token string">&quot;quality&quot;</span>
     <span class="token punctuation">}</span><span class="token punctuation">,</span>
     <span class="token property">&quot;sharpness&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;Value&quot;</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span>
        <span class="token property">&quot;Id&quot;</span><span class="token operator">:</span><span class="token string">&quot;sharpness&quot;</span>
     <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>With the desired output being :</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;Rating&quot;</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span>
  <span class="token property">&quot;RatingRange&quot;</span> <span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
  <span class="token property">&quot;SecondaryRatings&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
     <span class="token property">&quot;quality&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token property">&quot;Range&quot;</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">,</span>
        <span class="token property">&quot;Value&quot;</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span>
        <span class="token property">&quot;Id&quot;</span><span class="token operator">:</span><span class="token string">&quot;quality&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;ValueLabel&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">&quot;Label&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">&quot;MaxLabel&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Great&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;MinLabel&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Terrible&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;DisplayType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;NORMAL&quot;</span>
     <span class="token punctuation">}</span><span class="token punctuation">,</span>
     <span class="token property">&quot;sharpness&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;Range&quot;</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span>
        <span class="token property">&quot;Value&quot;</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">,</span>
        <span class="token property">&quot;Id&quot;</span><span class="token operator">:</span><span class="token string">&quot;sharpness&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;ValueLabel&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">&quot;Label&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">&quot;MaxLabel&quot;</span><span class="token operator">:</span> <span class="token string">&quot;High&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;MinLabel&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Low&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;DisplayType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;NORMAL&quot;</span>
     <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Spec</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;RatingRange&quot;</span> <span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
  <span class="token property">&quot;SecondaryRatings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;quality|value&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
       <span class="token property">&quot;ValueLabel&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
       <span class="token property">&quot;Label&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
       <span class="token property">&quot;MaxLabel&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Great&quot;</span><span class="token punctuation">,</span>
       <span class="token property">&quot;MinLabel&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Terrible&quot;</span><span class="token punctuation">,</span>
       <span class="token property">&quot;DisplayType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;NORMAL&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;*&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
       <span class="token property">&quot;Range&quot;</span> <span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
       <span class="token property">&quot;ValueLabel&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
       <span class="token property">&quot;Label&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
       <span class="token property">&quot;MaxLabel&quot;</span><span class="token operator">:</span> <span class="token string">&quot;High&quot;</span><span class="token punctuation">,</span>
       <span class="token property">&quot;MinLabel&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Low&quot;</span><span class="token punctuation">,</span>
       <span class="token property">&quot;DisplayType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;NORMAL&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+h+`" alt="" loading="lazy"></p><h3 id="wildcard-6" tabindex="-1"><a class="header-anchor" href="#wildcard-6" aria-hidden="true">#</a> wildcard</h3><ol><li>&#39;*&#39; Apply these defaults to all input keys at this level</li><li>&#39;|&#39; Apply these defaults to input keys, if they exist</li><li>&#39;[]&#39; Signal to Defaultr that the data for this key should be an array.This means all defaultr keys below this entry have to be &quot;integers&quot;.</li></ol><p>Valid Array Specification :</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
   <span class="token property">&quot;photos[]&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
     <span class="token property">&quot;2&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
       <span class="token property">&quot;url&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;http://www.bazaarvoice.com&quot;</span><span class="token punctuation">,</span>
       <span class="token property">&quot;caption&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
     <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Algorithm\uFF1A</p><ol><li>Defaultr walks its Spec in a depth first way.</li><li>At each level in the Spec tree, Defaultr, works from most specific to least specific Spec key: <ul><li>Literals key values</li><li>&quot;|&quot;, sub-sorted by how many or values there, then alphabetically (for deterministic behavior)</li><li>&quot;*&quot;</li></ul></li></ol><p>At a given level in the Defaultr Spec tree, only literal keys force Defaultr to create new entries in the input data: either as a single literal value or adding new nested Array or Map objects.The wildcard operators, are applied after the literal keys, and will not cause the those keys to be added if they are not already present in the input document (either naturally or having been defaulted in from literal spec keys).</p><p>Algorithm :</p><ul><li>1 Walk the spec</li><li>2 for each literal key in the spec (specKey) <ul><li>if the the specKey is a map or array, and the input is null, default an empty Map or Array into the output</li><li>re-curse on the literal spec</li><li>if the the specKey is a map or array, and the input is not null, but of the &quot;wrong&quot; type, skip and do not recurse</li><li>if the the specKey, is a literal value, default the literal and value into the output and do not recurse</li></ul></li><li>3 for each wildcard in the spec <ul><li>find all keys from the defaultee that match the wildcard</li><li>treat each key as a literal speckey</li></ul></li></ul><p>To force unambiguity, Defaultr throws an Exception if the input is null.</p><h2 id="remove" tabindex="-1"><a class="header-anchor" href="#remove" aria-hidden="true">#</a> remove</h2><p>remove is a kind of JOLT transform that removes content from the input JSON.</p><p>For comparison :</p><ul><li>Shiftr walks the input data and asks its spec &quot;Where should this go?&quot;</li><li>Defaultr walks the spec and asks &quot;Does this exist in the data? If not, add it.&quot;</li><li>While, Removr walks the spec and asks &quot;if this exists, remove it.&quot;</li></ul><p>Example : Given input JSON like</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;~emVersion&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;2&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;123124&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;productId&quot;</span><span class="token operator">:</span><span class="token string">&quot;31231231&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;submissionId&quot;</span><span class="token operator">:</span><span class="token string">&quot;34343&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;this&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;stays&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;configured&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;a&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;b&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;c&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;d&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>With the desired output being :</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;123124&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;this&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;stays&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;configured&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;a&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;b&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Spec\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;~emVersion&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;productId&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;submissionId&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;configured&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;c&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+g+`" alt="" loading="lazy"></p><h3 id="wildcard-7" tabindex="-1"><a class="header-anchor" href="#wildcard-7" aria-hidden="true">#</a> Wildcard</h3><p>&#39;<em>&#39; Valid only on the LHS ( input JSON keys ) side of a Removr Spec,The &#39;</em>&#39; wildcard can be used by itself or to match part of a key.</p><p>&#39;*&#39; wildcard by itself :</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;ratings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;Set1&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;a&quot;</span><span class="token operator">:</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;b&quot;</span><span class="token operator">:</span> <span class="token string">&quot;b&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;Set2&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;c&quot;</span><span class="token operator">:</span> <span class="token string">&quot;c&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;b&quot;</span><span class="token operator">:</span> <span class="token string">&quot;b&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>desired output:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;ratings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;Set1&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;a&quot;</span><span class="token operator">:</span> <span class="token string">&quot;a&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;Set2&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;c&quot;</span><span class="token operator">:</span> <span class="token string">&quot;c&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Spec:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
 <span class="token property">&quot;ratings&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;*&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">&quot;b&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+y+`" alt="" loading="lazy"></p><p>&#39;*&#39; wildcard as part of a key :</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;ratings_legacy&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;Set1&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;a&quot;</span><span class="token operator">:</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;b&quot;</span><span class="token operator">:</span> <span class="token string">&quot;b&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;Set2&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;a&quot;</span><span class="token operator">:</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;b&quot;</span><span class="token operator">:</span> <span class="token string">&quot;b&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;ratings_new&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;Set1&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;a&quot;</span><span class="token operator">:</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;b&quot;</span><span class="token operator">:</span> <span class="token string">&quot;b&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;Set2&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;a&quot;</span><span class="token operator">:</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;b&quot;</span><span class="token operator">:</span> <span class="token string">&quot;b&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Spec</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
      <span class="token property">&quot;ratings_*&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;Set1&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>desired oiuput json:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;ratings_legacy&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;Set2&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;a&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;b&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;b&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;ratings_new&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;Set2&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;a&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;b&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;b&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+f+'" alt="" loading="lazy"></p><p>Here are two more examples of matching array indexes:</p><p>Delete one member of each element of the array: <img src="'+w+'" alt="" loading="lazy"> Remove array elements with index 0: <img src="'+S+`" alt="" loading="lazy"></p><h2 id="cardinality" tabindex="-1"><a class="header-anchor" href="#cardinality" aria-hidden="true">#</a> cardinality</h2><p>The CardinalityTransform changes the cardinality of input JSON data elements.The impetus for the CardinalityTransform, was to deal with data sources that are inconsistent with respect to the cardinality of their returned data.</p><p>For example, say you know that there will be a &quot;photos&quot; element in a document. If your underlying data source is trying to be nice, it may adjust the &quot;type&quot; of the photos element, depending on how many photos there actually are.</p><h3 id="valid-cardinality-values-rhs-right-hand-side" tabindex="-1"><a class="header-anchor" href="#valid-cardinality-values-rhs-right-hand-side" aria-hidden="true">#</a> Valid Cardinality Values (RHS : right hand side)</h3><p>&#39;ONE&#39;:If the input value is a List, grab the first element in that list, and set it as the data for that element .For all other input value types, no-op.</p><p>&#39;MANY&#39;:If the input is not a List, make a list and set the first element to be the input value.If the input is &quot;null&quot;, make it be an empty list.If the input is a list, no-op</p><p>Example\uFF1A</p><p>input json:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;review&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;rating&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Spec:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;review&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;rating&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;ONE&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>output:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;review&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;rating&quot;</span> <span class="token operator">:</span> <span class="token number">5</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+j+`" alt="" loading="lazy"></p><h3 id="wildcards" tabindex="-1"><a class="header-anchor" href="#wildcards" aria-hidden="true">#</a> Wildcards</h3><p>&#39;<em>&#39; Valid only on the LHS ( input JSON keys ) side of a Cardinality Spec.Unlike shiftr, the &#39;</em>&#39; wildcard can only be used by itself. It can be used achieve a for/each manner of processing input.</p><p>&#39;@&#39; Valid only on the LHS of the spec.This wildcard should be used when content nested within modified content needs to be modified as well.</p><p>Example input json:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;views&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> <span class="token property">&quot;count&quot;</span> <span class="token operator">:</span> <span class="token number">1024</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token property">&quot;count&quot;</span> <span class="token operator">:</span> <span class="token number">2048</span> <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Spec</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;views&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;@&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;ONE&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;count&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;MANY&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>output:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;views&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;count&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token number">1024</span> <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="sort" tabindex="-1"><a class="header-anchor" href="#sort" aria-hidden="true">#</a> sort</h2><p>Recursively sorts all maps within a JSON object into new sorted LinkedHashMaps so that serialized representations are deterministic. Useful for debugging and making test fixtures.</p><p>Note this will make a copy of the input Map and List objects.</p><p>The sort order is standard alphabetical ascending, with a special case for &quot;~&quot; prefixed keys to be bumped to the top.</p><p><img src="`+x+`" alt="" loading="lazy"></p><h2 id="modify" tabindex="-1"><a class="header-anchor" href="#modify" aria-hidden="true">#</a> modify</h2><p>modify-overwrite-beta:This variant of modifier creates the key/index is missing, and overwrites the value if present modify-default-beta:This variant of modifier only writes when the key/index is missing or the value is null modify-define-beta:This variant of modifier only writes when the key/index is missing</p><p>Modify mode contains a series of functions that are native to Java in nature. Below are the functions and their corresponding source code:</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Function</span><span class="token punctuation">&gt;</span></span> STOCK_FUNCTIONS <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>  <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;toLower&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Strings</span><span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;toUpper&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Strings</span><span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;concat&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Strings</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;join&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Strings</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;split&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Strings</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;substring&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Strings</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;trim&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Strings</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;leftPad&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Strings</span><span class="token punctuation">.</span><span class="token function">leftPad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;rightPad&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Strings</span><span class="token punctuation">.</span><span class="token function">rightPad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;min&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;max&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;abs&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;avg&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">avg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;intSum&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">intSum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;doubleSum&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">doubleSum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;longSum&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">longSum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;intSubtract&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">intSubtract</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;doubleSubtract&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">doubleSubtract</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;longSubtract&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">longSubtract</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;divide&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">divide</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;divideAndRound&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">divideAndRound</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>


        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;toInteger&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">toInteger</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;toDouble&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">toDouble</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;toLong&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">toLong</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;toBoolean&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">toBoolean</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;toString&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;size&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;squashNulls&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">squashNulls</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;recursivelySquashNulls&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">recursivelySquashNulls</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;noop&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Function</span><span class="token punctuation">.</span>noop <span class="token punctuation">)</span><span class="token punctuation">;</span>
        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;isPresent&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Function</span><span class="token punctuation">.</span>isPresent <span class="token punctuation">)</span><span class="token punctuation">;</span>
        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;notNull&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Function</span><span class="token punctuation">.</span>notNull <span class="token punctuation">)</span><span class="token punctuation">;</span>
        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;isNull&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Function</span><span class="token punctuation">.</span>isNull <span class="token punctuation">)</span><span class="token punctuation">;</span>

        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;firstElement&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Lists</span><span class="token punctuation">.</span><span class="token function">firstElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;lastElement&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Lists</span><span class="token punctuation">.</span><span class="token function">lastElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;elementAt&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Lists</span><span class="token punctuation">.</span><span class="token function">elementAt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;toList&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Lists</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        STOCK_FUNCTIONS<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span> <span class="token string">&quot;sort&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Lists</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Example input json:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;x&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;go&quot;</span>  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;small&quot;</span><span class="token operator">:</span> <span class="token string">&quot;small&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;BIG&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BIG&quot;</span><span class="token punctuation">,</span>

  <span class="token property">&quot;people&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;firstName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Bob&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;lastName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Smith&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;state&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;firstName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Sterling&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;lastName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Archer&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Spec</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token property">&quot;operation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;modify-default-beta&quot;</span><span class="token punctuation">,</span><span class="token comment">//\u503C\u4E3Anull\u65F6\u5199\u5165</span>
    <span class="token property">&quot;spec&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// String join the values in the array x, with a comma and a space</span>
      <span class="token property">&quot;y&quot;</span><span class="token operator">:</span> <span class="token string">&quot;=join(&#39;,&#39;,@(1,x))&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;z&quot;</span><span class="token operator">:</span> <span class="token string">&quot;=join(&#39; &#39;,@(1,x))&quot;</span><span class="token punctuation">,</span>
      <span class="token comment">//</span>
      <span class="token comment">// make small big, and make big small</span>
      <span class="token property">&quot;small_toUpper&quot;</span><span class="token operator">:</span> <span class="token string">&quot;=toUpper(@(1,small))&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;BIG_toLower&quot;</span><span class="token operator">:</span> <span class="token string">&quot;=toLower(@(1,BIG))&quot;</span><span class="token punctuation">,</span>
      <span class="token comment">//</span>
      <span class="token comment">// Here we are dealing with an array of people objects.</span>
      <span class="token comment">// We want to build a fullName for them, and default them</span>
      <span class="token comment">// to &#39;live&#39; in Texas, only if they don&#39;t already have an address defined.</span>
      <span class="token property">&quot;people&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;*&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token comment">// build the fullName from the first and last names</span>
          <span class="token comment">//</span>
          <span class="token comment">// @(1,firstName)</span>
          <span class="token comment">//  -  is &quot;evaluated&quot; before being passed to the =concat function.</span>
          <span class="token comment">//  -  means go up two levels, and then come back down and grab</span>
          <span class="token comment">//      the value from firstName</span>
          <span class="token property">&quot;fullName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;=concat(@(1,firstName),&#39; &#39;,@(1,lastName))&quot;</span><span class="token punctuation">,</span>
          <span class="token comment">//</span>
          <span class="token comment">// Suffix of &quot;?&quot; means only match if the input actually has an &quot;address&quot;</span>
          <span class="token property">&quot;address?&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token comment">// The transform &quot;modify-default-beta&quot; will only match if the</span>
            <span class="token comment">//  &quot;left hand side&quot; does not exist or is null</span>
            <span class="token property">&quot;state&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Texas&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="extended" tabindex="-1"><a class="header-anchor" href="#extended" aria-hidden="true">#</a> Extended</h2><p>full qualified Java ClassName : Class implements the Transform or ContextualTransform interfaces, and can optionally be SpecDriven (marker interface)</p>`,172),hn={href:"https://github.com/bazaarvoice/jolt/blob/master/jolt-core/src/main/java/com/bazaarvoice/jolt/Transform.java",target:"_blank",rel:"noopener noreferrer"},gn=s("Transform"),yn={href:"https://github.com/bazaarvoice/jolt/blob/master/jolt-core/src/main/java/com/bazaarvoice/jolt/SpecDriven.java",target:"_blank",rel:"noopener noreferrer"},fn=s("SpecDriven"),wn=e(`<p>Spec like\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
          <span class="token property">&quot;operation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;com.bazaarvoice.tuna.CustomTransform&quot;</span><span class="token punctuation">,</span>
 
          <span class="token property">&quot;spec&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> ... <span class="token punctuation">}</span> <span class="token comment">// optional spec to use to construct a custom {@link Transform} if it has the {@link SpecDriven} marker interface.</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">//...</span>
  <span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="chainr" tabindex="-1"><a class="header-anchor" href="#chainr" aria-hidden="true">#</a> Chainr</h2><p>Chainr is a mechanism for wiring together multiple conversion Spec like:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
          <span class="token property">&quot;operation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;[operation-name]&quot;</span><span class="token punctuation">,</span>
          <span class="token comment">// stuff that the specific transform needs go here</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">//...</span>
 <span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>operation-name may be shift\u3001default\u3001remove\u3001cardinality\u3001sort\u3001java\u3001modify-overwrite-beta\u3001modify-default-beta\u3001modify-define-beta</p><p>Example\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token comment">// Input data for the unit test</span>
    <span class="token property">&quot;input&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;rating&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;primary&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
                <span class="token property">&quot;max&quot;</span><span class="token operator">:</span> <span class="token number">5</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">&quot;sharpness&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
                <span class="token property">&quot;max&quot;</span><span class="token operator">:</span> <span class="token number">5</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">&quot;quality&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
                <span class="token property">&quot;max&quot;</span><span class="token operator">:</span> <span class="token number">7</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">// The test uses this Chainr spec, on the input data to produce the &quot;expected&quot; JSON below</span>
    <span class="token property">&quot;spec&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token comment">// first operation is shift</span>
            <span class="token property">&quot;operation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shift&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;spec&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;rating&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;primary&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                        <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Rating&quot;</span><span class="token punctuation">,</span>
                        <span class="token property">&quot;max&quot;</span><span class="token operator">:</span> <span class="token string">&quot;RatingRange&quot;</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;*&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                        <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;SecondaryRatings.&amp;1.Value&quot;</span><span class="token punctuation">,</span>
                        <span class="token property">&quot;max&quot;</span><span class="token operator">:</span> <span class="token string">&quot;SecondaryRatings.&amp;1.Range&quot;</span><span class="token punctuation">,</span>
                        <span class="token property">&quot;$&quot;</span><span class="token operator">:</span> <span class="token string">&quot;SecondaryRatings.&amp;.Id&quot;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token comment">// second operation is to default some values</span>
            <span class="token property">&quot;operation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;default&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;spec&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;~z&quot;</span><span class="token operator">:</span> <span class="token string">&quot;zz&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;~a&quot;</span><span class="token operator">:</span> <span class="token string">&quot;aa&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;~id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;zz&quot;</span><span class="token operator">:</span> <span class="token string">&quot;zz&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;~deleteme&quot;</span><span class="token operator">:</span> <span class="token string">&quot;deleteme&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token comment">// third operation is to remove something</span>
            <span class="token property">&quot;operation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;remove&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;spec&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;~deleteme&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token comment">// last operation is to sort the JSON</span>
            <span class="token property">&quot;operation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sort&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>

    <span class="token comment">// The expected result</span>
    <span class="token property">&quot;expected&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;~a&quot;</span><span class="token operator">:</span> <span class="token string">&quot;aa&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;~id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;~z&quot;</span><span class="token operator">:</span> <span class="token string">&quot;zz&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;Rating&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
        <span class="token property">&quot;RatingRange&quot;</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
        <span class="token property">&quot;SecondaryRatings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;quality&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;Id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;quality&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;Range&quot;</span><span class="token operator">:</span> <span class="token number">7</span><span class="token punctuation">,</span>
                <span class="token property">&quot;Value&quot;</span><span class="token operator">:</span> <span class="token number">3</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">&quot;sharpness&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;Id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sharpness&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;Range&quot;</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
                <span class="token property">&quot;Value&quot;</span><span class="token operator">:</span> <span class="token number">5</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;zz&quot;</span><span class="token operator">:</span> <span class="token string">&quot;zz&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+_+`" alt="" loading="lazy"></p><p>Let&#39;s take another example of a slightly more complicated practical Issue I saw on the JOLT GitHub Issue(<a href="https://github.com/bazaarvoice/jolt/issues/900">Conditional based on a input field #900</a>)</p><p>input json:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;addressBook&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;primaryAddress&quot;</span><span class="token operator">:</span> <span class="token string">&quot;pxDdd&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;addresses&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;pxDd&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;fullName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Daniel Garcia&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;street&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Berenguer&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;houseNumber&quot;</span><span class="token operator">:</span> <span class="token string">&quot;234&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;houseName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;floorNo&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;streetType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Str&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;doorNo&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;postOfficeBox&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;city&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Barcelona&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;zipCode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;08812&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;state&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;province&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;addressLine1&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;addressLine2&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;addressLine3&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;countryCode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ES&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;pxDdd&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;fullName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Daniel Garcia&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;street&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Berenguer&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;houseNumber&quot;</span><span class="token operator">:</span> <span class="token string">&quot;234&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;houseName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;floorNo&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;streetType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Str&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;doorNo&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;postOfficeBox&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;city&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Barcelona&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;zipCode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;08812&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;state&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;province&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;addressLine1&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;addressLine2&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;addressLine3&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;countryCode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ES&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The ouput file should contains the address that has the same id value than the primaryAddress field value. In case there is not a primaryAddres field, the first address should be written to the output.And I assume that if more than one have the same id value than the primaryAddress field value, we only need one</p><p>The Spec scheme I have given is as follows. This Spec concatenates the three operations of default\u3001 shift \u3001cardinality:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token property">&quot;operation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;default&quot;</span><span class="token punctuation">,</span><span class="token comment">//if primaryAddress not exist,add a primaryAddress field</span>
    <span class="token property">&quot;spec&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;addressBook&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;primaryAddress&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">&quot;operation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shift&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;spec&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;addressBook&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;primaryAddress&quot;</span><span class="token operator">:</span> <span class="token string">&quot;addressBook.primaryAddress&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;addresses&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;*&quot;</span><span class="token operator">:</span> <span class="token string">&quot;addressBook.addresses.@(2,primaryAddress)&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">&quot;operation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shift&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;spec&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;addressBook&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;primaryAddress&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>             
            <span class="token property">&quot;@(2,addresses)&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token property">&quot;&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;0&quot;</span><span class="token operator">:</span> <span class="token string">&quot;address[]&quot;</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;addresses&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;*&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;*&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;&amp;2&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>  
                  <span class="token property">&quot;@2&quot;</span><span class="token operator">:</span> <span class="token string">&quot;address[]&quot;</span>
                <span class="token punctuation">}</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;operation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cardinality&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;spec&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ONE&quot;</span>  
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>


</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>result\uFF1A <img src="`+N+`" alt="" loading="lazy"></p><h2 id="java-call" tabindex="-1"><a class="header-anchor" href="#java-call" aria-hidden="true">#</a> Java call</h2><p>add Maven Dependency</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.bazaarvoice.jolt<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jolt-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>\${latest.jolt.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.bazaarvoice.jolt<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>json-utils<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>\${latest.jolt.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,19),Sn={href:"https://github.com/bazaarvoice/jolt/releases",target:"_blank",rel:"noopener noreferrer"},jn=s("Release Notes"),xn=e(`<ul><li><p>jolt-core :only one dependency on apache.commons for StringUtils.The goal is for the jolt-core artifact to be pure Java, so that it does not cause any dependency issues.</p></li><li><p>json-utils : Jackson wrapper and testing utilities. Used by jolt-core as a test dependency.If you are willing to pull in Jackson 2, this artifact provides nice utility methods.</p></li></ul><p>Code and Sample Data:</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>bazaarvoice<span class="token punctuation">.</span>jolt<span class="token punctuation">.</span>sample</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>bazaarvoice<span class="token punctuation">.</span>jolt<span class="token punctuation">.</span></span><span class="token class-name">Chainr</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>bazaarvoice<span class="token punctuation">.</span>jolt<span class="token punctuation">.</span></span><span class="token class-name">JsonUtils</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JoltSample</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>

        <span class="token comment">// How to access the test artifacts, i.e. JSON files</span>
        <span class="token comment">//  JsonUtils.classpathToList : assumes you put the test artifacts in your class path</span>
        <span class="token comment">//  JsonUtils.filepathToList : you can use an absolute path to specify the files</span>

        <span class="token class-name">List</span> chainrSpecJSON <span class="token operator">=</span> <span class="token class-name">JsonUtils</span><span class="token punctuation">.</span><span class="token function">classpathToList</span><span class="token punctuation">(</span> <span class="token string">&quot;/json/sample/spec.json&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Chainr</span> chainr <span class="token operator">=</span> <span class="token class-name">Chainr</span><span class="token punctuation">.</span><span class="token function">fromSpec</span><span class="token punctuation">(</span> chainrSpecJSON <span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Object</span> inputJSON <span class="token operator">=</span> <span class="token class-name">JsonUtils</span><span class="token punctuation">.</span><span class="token function">classpathToObject</span><span class="token punctuation">(</span> <span class="token string">&quot;/json/sample/input.json&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Object</span> transformedOutput <span class="token operator">=</span> chainr<span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span> inputJSON <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span> <span class="token class-name">JsonUtils</span><span class="token punctuation">.</span><span class="token function">toJsonString</span><span class="token punctuation">(</span> transformedOutput <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>input json:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;rating&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;primary&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">3</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;quality&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">3</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Spec</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token property">&quot;operation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shift&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;spec&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;rating&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;primary&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Rating&quot;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token property">&quot;*&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;SecondaryRatings.&amp;1.Value&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;$&quot;</span><span class="token operator">:</span> <span class="token string">&quot;SecondaryRatings.&amp;.Id&quot;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token property">&quot;operation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;default&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;spec&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;Range&quot;</span> <span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
            <span class="token property">&quot;SecondaryRatings&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;*&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;Range&quot;</span> <span class="token operator">:</span> <span class="token number">5</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>output:</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;Rating&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token property">&quot;Range&quot;</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
    <span class="token property">&quot;SecondaryRatings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;quality&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;Id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;quality&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;Value&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
            <span class="token property">&quot;Range&quot;</span><span class="token operator">:</span> <span class="token number">5</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,9);function _n(Nn,On){const a=T("ExternalLinkIcon");return I(),R("div",null,[C,L,n("p",null,[z,n("a",A,[F,t(a)])]),n("p",null,[U,n("a",H,[V,t(a)])]),n("p",null,[K,n("a",D,[M,t(a)]),B]),E,n("ul",null,[n("li",null,[n("p",null,[n("a",P,[W,t(a)]),$])]),n("li",null,[n("p",null,[n("a",G,[Y,t(a)]),Q])]),n("li",null,[n("p",null,[n("a",X,[Z,t(a)]),nn])])]),sn,n("p",null,[an,n("a",tn,[en,t(a)])]),on,n("p",null,[pn,n("a",ln,[un,t(a)]),cn]),rn,n("ol",null,[n("li",null,[dn,n("a",kn,[vn,t(a)]),mn]),qn]),bn,n("p",null,[n("a",hn,[gn,t(a)])]),n("p",null,[n("a",yn,[fn,t(a)])]),wn,n("p",null,[n("a",Sn,[jn,t(a)])]),xn])}var Jn=O(J,[["render",_n],["__file","JsonJolt\u6559\u7A0B\u82F1\u6587\u7248.html.vue"]]);export{Jn as default};
